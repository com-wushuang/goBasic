## 什么是索引?
索引是一种数据结构「平衡树」(非二叉)。数据库索引，是数据库管理系统中一个排序的数据结构，以协助快速查询、更新数据库表中数据。索引的实现通常使用B树及其变种B+树。

## 索引的分类
### 按字段特性分类
MySQL索引按字段特性分类可分为:
- 主键索引: 建立在主键上的索引被称为主键索引，一张数据表只能有一个主键索引，索引列值不允许有空值，通常在创建表时一起创建。
- 普通索引: 建立在 `UNIQUE` 字段上的索引被称为唯一索引，一张表可以有多个唯一索引，索引列值允许为空，列值中出现多个空值不会发生重复冲突。
- 前缀索引: 建立在普通字段上的索引被称为普通索引。
- 前缀索引: 对字符类型字段的前几个字符或对二进制类型字段的前几个bytes建立的索引，而不是在整个字段上建索引。前缀索引可以建立在类型为char、varchar、binary、varbinary的列上，可以大大减少索引占用的存储空间，也能提升索引的查询效率。

### 按索引字段个数分类
MySQL索引按字段个数分类可分为:
- 单列索引: 建立在单个列上的索引被称为单列索引。
- 联合索引: 建立在多个列上的索引被称为联合索引，又叫复合索引、组合索引。

### 按物理存储分类
MySQL 索引按叶子节点存储的是否为完整表数据分为:
1. 聚簇索引
2. 二级索引（辅助索引）。

#### 聚簇索引
聚簇索引的每个叶子节点存储了一行完整的表数据，叶子节点间按id列递增连接，可以方便地进行顺序检索。
![cluster_index](https://github.com/com-wushuang/goBasic/blob/main/image/cluster_index.png)
`InnoDB` 表要求必须有聚簇索引，默认在主键字段上建立聚簇索引，在没有主键字段的情况下，表的第一个非空的唯一索引将被建立为聚簇索引，在前两者都没有的情况下，`InnoDB` 将自动生成一个隐式的自增 `id` 列，并在此列上建立聚簇索引。

#### 二级索引
- 二级索引的叶子节点并不存储一行完整的表数据，而是存储了聚簇索引所在列的值。
 ![none_cluster_index](https://github.com/com-wushuang/goBasic/blob/main/image/none_cluster_index.png)
**回表查询**
- 由于二级索引的叶子节点不存储完整的表数据，索引当通过二级索引查询到聚簇索引列值后，还需要回到聚簇索引也就是表数据本身进一步获取数据。
![lookback_index](https://github.com/com-wushuang/goBasic/blob/main/image/lookback_index.png)
- 回表查询 需要额外的 B+tree 搜索过程，必然增大查询耗时。
- 需要注意的是，通过二级索引查询时，回表不是必须的过程，当 `SELECT` 的所有字段在单个二级索引中都能够找到时，就不需要回表，`MySQL` 称此时的二级索引为覆盖索引或触发了索引覆盖。
- 可以用 `Explain` 命令查看SQL语句的执行计划，执行计划的 `Extra` 字段中若出现 `Using index`，表示查询触发了索引覆盖。

